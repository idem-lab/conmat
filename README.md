
<!-- README.md is generated from README.Rmd. Please edit that file -->

# conmat

<!-- badges: start -->

[![Codecov test
coverage](https://codecov.io/gh/njtierney/conmat/branch/master/graph/badge.svg)](https://codecov.io/gh/njtierney/conmat?branch=master)
[![R-CMD-check](https://github.com/njtierney/conmat/workflows/R-CMD-check/badge.svg)](https://github.com/njtierney/conmat/actions)
<!-- badges: end -->

The goal of conmat is to provide methods for producing contact matrices.

## Installation

You can install the development version with:

``` r
install.packages("conmat", repos = "https://njtierney.r-universe.dev")
```

Or alternatively you can use `remotes` (although I recommend using the
above code)

``` r
# install.packages("remotes")
remotes::install_github("njtierney/conmat")
```

## Example

We can extract out the ABS age population data using `abs_age_lga` like
so:

``` r
library(conmat)
sydney_age_pop <- abs_age_lga("Sydney (C)")
sydney_age_pop
#> # A tibble: 18 × 4
#>    lga        lower.age.limit  year population
#>    <chr>                <dbl> <dbl>      <dbl>
#>  1 Sydney (C)               0  2020       9109
#>  2 Sydney (C)               5  2020       5034
#>  3 Sydney (C)              10  2020       3718
#>  4 Sydney (C)              15  2020       7492
#>  5 Sydney (C)              20  2020      31981
#>  6 Sydney (C)              25  2020      45686
#>  7 Sydney (C)              30  2020      38333
#>  8 Sydney (C)              35  2020      25550
#>  9 Sydney (C)              40  2020      15768
#> 10 Sydney (C)              45  2020      12843
#> 11 Sydney (C)              50  2020      10964
#> 12 Sydney (C)              55  2020      10532
#> 13 Sydney (C)              60  2020       8950
#> 14 Sydney (C)              65  2020       7377
#> 15 Sydney (C)              70  2020       6308
#> 16 Sydney (C)              75  2020       4002
#> 17 Sydney (C)              80  2020       2583
#> 18 Sydney (C)              85  2020       2506
```

Note that you need to use the exact LGA name - you can look up LGA names
in the data set `abs_lga_lookup`:

``` r
abs_lga_lookup
#> # A tibble: 545 × 3
#>    state lga_code lga                  
#>    <chr>    <dbl> <chr>                
#>  1 NSW      10050 Albury (C)           
#>  2 NSW      10180 Armidale Regional (A)
#>  3 NSW      10250 Ballina (A)          
#>  4 NSW      10300 Balranald (A)        
#>  5 NSW      10470 Bathurst Regional (A)
#>  6 NSW      10500 Bayside (A)          
#>  7 NSW      10550 Bega Valley (A)      
#>  8 NSW      10600 Bellingen (A)        
#>  9 NSW      10650 Berrigan (A)         
#> 10 NSW      10750 Blacktown (C)        
#> # … with 535 more rows
```

First we want to fit the model to the polymod data

``` r
set.seed(2021-09-24)
polymod_contact_data <- get_polymod_setting_data()
polymod_survey_data <- get_polymod_population()

setting_models <- fit_setting_contacts(
  contact_data_list = polymod_contact_data,
  population = polymod_survey_data
  )
```

Then we take this model and extrapolate to the sydney data:

``` r
set.seed(2021-09-24)
synthetic_settings_5y_sydney <- predict_setting_contacts(
  population = sydney_age_pop,
  contact_model = setting_models,
  age_breaks = c(seq(0, 85, by = 5), Inf)
  )
  
synthetic_settings_5y_sydney
#> $home
#>               [0,5)     [5,10)    [10,15)   [15,20)    [20,25)    [25,30)
#> [0,5)    0.40803304 0.30903656 0.19505611 0.2031604 0.33037397 0.57805460
#> [5,10)   0.29032146 0.52734719 0.33976986 0.1924097 0.16931715 0.26804927
#> [10,15)  0.13041788 0.31688191 0.59604171 0.3899357 0.17893718 0.13642289
#> [15,20)  0.08693361 0.11568502 0.28236827 0.6652340 0.39087789 0.14265866
#> [20,25)  0.13254210 0.08387506 0.11377223 0.3226243 0.66630918 0.32814724
#> [25,30)  0.27839755 0.14433928 0.08412948 0.1233044 0.33927314 0.66349723
#> [30,35)  0.39041726 0.33864324 0.16567130 0.1015536 0.13567905 0.34216219
#> [35,40)  0.26989588 0.46799600 0.38093550 0.1995392 0.11703891 0.14084432
#> [40,45)  0.12636127 0.29908265 0.47706648 0.4160341 0.21532640 0.12138613
#> [45,50)  0.08557730 0.13991142 0.28466979 0.4618561 0.38607197 0.20047399
#> [50,55)  0.10070211 0.09995692 0.13650559 0.2698345 0.39912265 0.32930807
#> [55,60)  0.13158679 0.12167279 0.10217983 0.1374254 0.24436086 0.34511866
#> [60,65)  0.12661593 0.14886130 0.11846856 0.1013910 0.12721242 0.21882211
#> [65,70)  0.09022712 0.12628452 0.13047292 0.1093891 0.09025839 0.11330340
#> [70,75)  0.07291526 0.09193829 0.11242859 0.1210887 0.09707089 0.08338585
#> [75,80)  0.08222623 0.08903947 0.09767908 0.1219333 0.12143935 0.09913637
#> [80,85)  0.10114898 0.12381916 0.11980110 0.1322748 0.14790478 0.14741692
#> [85,Inf) 0.10249579 0.15994095 0.18581157 0.1893993 0.18509093 0.20351694
#>            [30,35)    [35,40)    [40,45)    [45,50)    [50,55)    [55,60)
#> [0,5)    0.7134122 0.51710368 0.27631859 0.18111802 0.17313765 0.17614426
#> [5,10)   0.5216641 0.67818556 0.46713519 0.22175144 0.12817586 0.11878528
#> [10,15)  0.2335938 0.49005780 0.64485773 0.42214286 0.17546716 0.08770436
#> [15,20)  0.1025428 0.17397570 0.37416019 0.50354025 0.31900125 0.12272135
#> [20,25)  0.1192818 0.08884608 0.15262617 0.31070229 0.37141615 0.21260701
#> [25,30)  0.3155155 0.11487359 0.08140448 0.13185866 0.24690619 0.27113882
#> [30,35)  0.6406517 0.31106463 0.11618241 0.07939684 0.11735358 0.20079978
#> [35,40)  0.3265150 0.56106831 0.27676050 0.10915579 0.07449316 0.10371068
#> [40,45)  0.1416188 0.29382312 0.46641275 0.23648324 0.09368433 0.06313848
#> [45,50)  0.1234715 0.14682317 0.28482554 0.43279747 0.20811161 0.07827923
#> [50,55)  0.1893404 0.12815504 0.15413835 0.29461136 0.44455817 0.20233454
#> [55,60)  0.3014750 0.18712799 0.13247159 0.16267576 0.31135458 0.46672437
#> [60,65)  0.3217744 0.29232458 0.18388073 0.13182238 0.16073590 0.30548189
#> [65,70)  0.2050035 0.30441229 0.26953503 0.16784153 0.11925153 0.14494988
#> [70,75)  0.1158541 0.20893862 0.28673549 0.23792756 0.14399546 0.10497613
#> [75,80)  0.0941309 0.13224137 0.21896162 0.27292024 0.21022427 0.12522475
#> [80,85)  0.1324991 0.12914481 0.16930851 0.25665008 0.29847945 0.22342727
#> [85,Inf) 0.2309056 0.22873678 0.21871414 0.26307106 0.37997917 0.46731829
#>             [60,65)    [65,70)    [70,75)    [75,80)    [80,85)    [85,Inf)
#> [0,5)    0.14042564 0.09084099 0.05664554 0.03364795 0.01595785 0.006050486
#> [5,10)   0.12428991 0.10508419 0.06863367 0.03923412 0.02056344 0.008978057
#> [10,15)  0.07383199 0.07702868 0.06549818 0.03991861 0.02013738 0.009803889
#> [15,20)  0.05387373 0.04247604 0.04391945 0.03544130 0.01932138 0.009004427
#> [20,25)  0.07683866 0.03506109 0.02947572 0.02888323 0.02028820 0.009922401
#> [25,30)  0.14206627 0.05115749 0.02607458 0.02248613 0.02029913 0.013002733
#> [30,35)  0.19993615 0.10106769 0.03921757 0.02093507 0.01749287 0.015205382
#> [35,40)  0.16008774 0.15128084 0.07898228 0.03079631 0.01585126 0.013360664
#> [40,45)  0.08113095 0.11952885 0.11685431 0.06010655 0.02231495 0.011405075
#> [45,50)  0.04919979 0.06003022 0.08896637 0.08265845 0.04003694 0.014704500
#> [50,55)  0.06753430 0.03877323 0.04580594 0.06227986 0.05290853 0.024794824
#> [55,60)  0.19486428 0.06108160 0.03427664 0.03610290 0.04256789 0.033808176
#> [60,65)  0.43693702 0.18180430 0.06001781 0.03132853 0.02806273 0.030728917
#> [65,70)  0.26435244 0.37820412 0.17182273 0.05745429 0.02684892 0.022425051
#> [70,75)  0.12903206 0.23526074 0.32626062 0.14810073 0.04835840 0.021780646
#> [75,80)  0.09199259 0.11709734 0.20947141 0.26944582 0.11984947 0.038603048
#> [80,85)  0.12896171 0.09312066 0.11326841 0.18115743 0.21117197 0.095020912
#> [85,Inf) 0.37721733 0.22159601 0.13783541 0.12411112 0.14866730 0.164677864
#> 
#> $work
#>                [0,5)      [5,10)      [10,15)     [15,20)     [20,25)
#> [0,5)    0.005701953 0.002170565 0.0009037083 0.001306734 0.002465681
#> [5,10)   0.001933265 0.002983066 0.0016839340 0.001870194 0.002774640
#> [10,15)  0.001724048 0.002962122 0.0088021992 0.014486635 0.016314524
#> [15,20)  0.008705238 0.010458115 0.0247997838 0.153683823 0.208632411
#> [20,25)  0.030741611 0.032690364 0.0515764853 0.221779107 0.748938688
#> [25,30)  0.050919962 0.054650494 0.0744640780 0.218287380 0.641556665
#> [30,35)  0.050485939 0.056769080 0.0794106515 0.217455397 0.513018873
#> [35,40)  0.047604962 0.055400837 0.0789367223 0.223835978 0.529228837
#> [40,45)  0.046176969 0.056248408 0.0796477076 0.221621421 0.526494545
#> [45,50)  0.041361431 0.053639361 0.0774273531 0.206053984 0.467909813
#> [50,55)  0.032291666 0.045394781 0.0693057489 0.183091424 0.391540243
#> [55,60)  0.018535175 0.029690669 0.0499065950 0.137084526 0.282464786
#> [60,65)  0.006775374 0.012453726 0.0243852164 0.074431326 0.153121509
#> [65,70)  0.002238937 0.004109643 0.0091685558 0.033417921 0.073322710
#> [70,75)  0.001518301 0.002036659 0.0042085432 0.017543619 0.045889539
#> [75,80)  0.002453286 0.001971735 0.0027031007 0.009745935 0.027987507
#> [80,85)  0.003434153 0.002086794 0.0017817023 0.004177141 0.009962351
#> [85,Inf) 0.001644522 0.001018468 0.0007149711 0.001138892 0.001883346
#>              [25,30)     [30,35)     [35,40)     [40,45)     [45,50)
#> [0,5)    0.003733181 0.004539991 0.004533564 0.004343600 0.004438307
#> [5,10)   0.003104700 0.003239610 0.003045808 0.002796660 0.002711639
#> [10,15)  0.013440928 0.011256715 0.009629285 0.008475539 0.007699966
#> [15,20)  0.141165820 0.098593550 0.074790574 0.063206618 0.056619288
#> [20,25)  0.686719009 0.441672677 0.307625907 0.244261558 0.213155538
#> [25,30)  1.155431033 0.885214554 0.597107598 0.456480856 0.385546990
#> [30,35)  0.835681170 0.951925081 0.713083373 0.535589975 0.448607399
#> [35,40)  0.796774300 0.877123303 0.801460003 0.629391445 0.514676359
#> [40,45)  0.795118072 0.864540642 0.812813272 0.738113357 0.601296031
#> [45,50)  0.693018198 0.742051678 0.688436792 0.655671858 0.644305777
#> [50,55)  0.552867933 0.584128650 0.533666709 0.494212655 0.509532023
#> [55,60)  0.370126650 0.379229255 0.355620366 0.334342613 0.335446329
#> [60,65)  0.185161405 0.172254121 0.157845103 0.157950969 0.166227485
#> [65,70)  0.086664845 0.072755643 0.058569243 0.056313707 0.062616883
#> [70,75)  0.061745108 0.051815497 0.036474614 0.029693361 0.030114628
#> [75,80)  0.045567920 0.044341276 0.031048704 0.021727678 0.018230977
#> [80,85)  0.016608749 0.018703914 0.014900055 0.010335316 0.007565409
#> [85,Inf) 0.002477807 0.002619118 0.002228698 0.001682579 0.001233995
#>               [50,55)      [55,60)      [60,65)      [65,70)      [70,75)
#> [0,5)    0.0042852154 0.0033850002 0.0018271064 7.135501e-04 2.321294e-04
#> [5,10)   0.0025354219 0.0021332022 0.0014386018 7.918871e-04 3.372768e-04
#> [10,15)  0.0064663948 0.0049164078 0.0033526430 2.300169e-03 1.470628e-03
#> [15,20)  0.0452512644 0.0307801868 0.0182402230 1.183825e-02 8.924461e-03
#> [20,25)  0.1687860655 0.1115949836 0.0594948331 3.216376e-02 2.216648e-02
#> [25,30)  0.2971584808 0.1936019437 0.0991581753 4.789620e-02 2.853042e-02
#> [30,35)  0.3417849178 0.2180775681 0.1104686093 5.263813e-02 2.945202e-02
#> [35,40)  0.3921935163 0.2525158944 0.1278012481 6.170069e-02 3.553029e-02
#> [40,45)  0.4396872369 0.2829331184 0.1469073226 7.278179e-02 4.409586e-02
#> [45,50)  0.4632911098 0.2793837823 0.1422417620 7.177588e-02 4.479230e-02
#> [50,55)  0.4759231040 0.2834265565 0.1319730673 6.328666e-02 3.861970e-02
#> [55,60)  0.3274632688 0.2664015152 0.1240277350 5.395171e-02 3.053934e-02
#> [60,65)  0.1599672491 0.1369460711 0.0905654898 4.069951e-02 2.125070e-02
#> [65,70)  0.0631252200 0.0531044994 0.0380027625 2.612167e-02 1.424318e-02
#> [70,75)  0.0301531441 0.0252557484 0.0174504569 1.304400e-02 1.071976e-02
#> [75,80)  0.0157328331 0.0121432542 0.0077275254 5.232480e-03 4.678373e-03
#> [80,85)  0.0053608616 0.0033955574 0.0018292644 1.040383e-03 7.845661e-04
#> [85,Inf) 0.0007941187 0.0004189346 0.0001746301 7.416847e-05 4.179662e-05
#>               [75,80)      [80,85)     [85,Inf)
#> [0,5)    0.0000778905 4.387321e-05 6.898287e-05
#> [5,10)   0.0001075016 3.614046e-05 2.646994e-05
#> [10,15)  0.0007017401 2.620462e-04 1.093370e-04
#> [15,20)  0.0063016149 3.721808e-03 1.936784e-03
#> [20,25)  0.0173408420 1.394903e-02 1.102987e-02
#> [25,30)  0.0206231055 1.826218e-02 1.994724e-02
#> [30,35)  0.0187526858 1.528627e-02 1.879087e-02
#> [35,40)  0.0224289874 1.686243e-02 1.946484e-02
#> [40,45)  0.0304437979 2.444911e-02 2.782648e-02
#> [45,50)  0.0330521701 3.030726e-02 3.988315e-02
#> [50,55)  0.0280788707 2.677524e-02 4.158814e-02
#> [55,60)  0.0205746455 1.781497e-02 2.704288e-02
#> [60,65)  0.0133400781 1.041782e-02 1.304925e-02
#> [65,70)  0.0084479285 6.446862e-03 7.416338e-03
#> [70,75)  0.0064199680 4.685594e-03 5.625247e-03
#> [75,80)  0.0045358148 3.136173e-03 3.487176e-03
#> [80,85)  0.0008763808 1.111520e-03 1.033511e-03
#> [85,Inf) 0.0000364368 5.900892e-05 1.203021e-04
#> 
#> $school
#>                [0,5)       [5,10)      [10,15)      [15,20)      [20,25)
#> [0,5)    2.731827130  0.758854955 8.028350e-02 1.866677e-02 1.434827e-02
#> [5,10)   0.577592429 14.713144341 2.177893e+00 4.741971e-02 2.098675e-02
#> [10,15)  0.017430971  1.452814801 2.559506e+01 1.211901e+00 1.916249e-02
#> [15,20)  0.031524764  0.063986009 8.846336e-01 4.428540e+00 2.479854e-01
#> [20,25)  0.078550604  0.135549560 1.406677e-01 1.773086e-01 4.047405e-01
#> [25,30)  0.089189591  0.254762283 2.864045e-01 6.794576e-02 3.300826e-02
#> [30,35)  0.086757770  0.255891603 3.764509e-01 1.109692e-01 2.340005e-02
#> [35,40)  0.118888458  0.322500313 3.765019e-01 1.031206e-01 2.439650e-02
#> [40,45)  0.141889395  0.457919137 5.229893e-01 1.081670e-01 1.673028e-02
#> [45,50)  0.165414103  0.586467524 7.582724e-01 1.670558e-01 2.088671e-02
#> [50,55)  0.197235875  0.660855609 8.171553e-01 1.942479e-01 2.963538e-02
#> [55,60)  0.155805250  0.524544588 5.353193e-01 1.051085e-01 1.611644e-02
#> [60,65)  0.045040303  0.197774484 1.984653e-01 3.269140e-02 4.385167e-03
#> [65,70)  0.006365736  0.033415004 4.264073e-02 7.968072e-03 1.654547e-03
#> [70,75)  0.004071042  0.009359003 8.604431e-03 1.515955e-03 4.106440e-04
#> [75,80)  0.011671394  0.006379516 2.196462e-03 1.991293e-04 3.717257e-05
#> [80,85)  0.036831489  0.005296336 4.408720e-04 1.283315e-05 7.678238e-07
#> [85,Inf) 0.028061705  0.004081606 1.230743e-04 8.359142e-07 8.369127e-09
#>               [25,30)      [30,35)      [35,40)      [40,45)      [45,50)
#> [0,5)    2.711888e-02 5.815556e-02 1.068454e-01 1.303681e-01 8.635919e-02
#> [5,10)   5.729870e-02 1.449167e-01 2.334398e-01 2.738103e-01 2.531369e-01
#> [10,15)  3.460858e-02 1.262927e-01 2.645533e-01 2.913503e-01 2.528735e-01
#> [15,20)  3.052704e-02 7.186033e-02 2.039479e-01 2.951352e-01 2.398152e-01
#> [20,25)  5.740883e-02 3.232282e-02 6.854585e-02 1.183385e-01 1.126722e-01
#> [25,30)  6.618058e-02 3.687819e-02 3.525483e-02 5.318389e-02 6.222757e-02
#> [30,35)  2.584520e-02 4.993232e-02 4.670961e-02 4.139973e-02 4.259349e-02
#> [35,40)  2.550818e-02 5.032161e-02 6.145794e-02 5.606628e-02 3.643322e-02
#> [40,45)  1.533816e-02 3.964981e-02 7.667544e-02 7.414821e-02 5.473156e-02
#> [45,50)  1.113489e-02 1.967116e-02 4.832749e-02 8.572821e-02 7.667174e-02
#> [50,55)  1.657032e-02 2.025304e-02 2.937277e-02 5.255780e-02 8.112808e-02
#> [55,60)  1.187446e-02 1.890160e-02 2.528183e-02 2.931266e-02 4.161641e-02
#> [60,65)  3.286115e-03 7.040051e-03 1.427748e-02 1.883240e-02 1.960798e-02
#> [65,70)  1.466193e-03 2.840970e-03 7.219644e-03 1.483466e-02 1.928397e-02
#> [70,75)  5.303905e-04 1.313854e-03 3.765400e-03 9.783726e-03 1.747483e-02
#> [75,80)  5.735793e-05 2.433332e-04 1.136080e-03 4.083130e-03 1.026364e-02
#> [80,85)  6.450806e-07 3.109016e-06 2.651842e-05 1.614696e-04 5.981533e-04
#> [85,Inf) 1.188579e-09 1.884220e-09 1.392885e-08 1.329916e-07 7.761163e-07
#>               [50,55)      [55,60)      [60,65)      [65,70)      [70,75)
#> [0,5)    3.994315e-02 1.946276e-02 1.470157e-02 9.822612e-03 4.272752e-03
#> [5,10)   1.678874e-01 6.872014e-02 2.794103e-02 1.461121e-02 7.932458e-03
#> [10,15)  2.106068e-01 1.065490e-01 3.755973e-02 1.395772e-02 7.591287e-03
#> [15,20)  1.748521e-01 9.521134e-02 3.492510e-02 9.488911e-03 3.374884e-03
#> [20,25)  7.766368e-02 3.942451e-02 1.714087e-02 5.981541e-03 1.453292e-03
#> [25,30)  4.896749e-02 2.452572e-02 1.212203e-02 5.855832e-03 1.206614e-03
#> [30,35)  4.060471e-02 2.490886e-02 1.447655e-02 9.074046e-03 2.454534e-03
#> [35,40)  2.535084e-02 1.623510e-02 1.213574e-02 1.121074e-02 4.951130e-03
#> [40,45)  2.634329e-02 9.297398e-03 5.185854e-03 5.721361e-03 4.159400e-03
#> [45,50)  5.205140e-02 1.531451e-02 3.975238e-03 2.364584e-03 1.630613e-03
#> [50,55)  7.026241e-02 3.617590e-02 1.018352e-02 3.107261e-03 1.046611e-03
#> [55,60)  5.694342e-02 3.618782e-02 1.783154e-02 6.046713e-03 1.327892e-03
#> [60,65)  2.516722e-02 2.668292e-02 1.942961e-02 7.544123e-03 1.403468e-03
#> [65,70)  1.891264e-02 1.702305e-02 1.841524e-02 1.593138e-02 2.797317e-03
#> [70,75)  1.809984e-02 1.036751e-02 6.620958e-03 9.330677e-03 1.695916e-02
#> [75,80)  1.412479e-02 7.409052e-03 2.217919e-03 1.198218e-03 5.313129e-03
#> [80,85)  1.241427e-03 9.130483e-04 2.456629e-04 5.108954e-05 5.626153e-05
#> [85,Inf) 2.214522e-06 2.457452e-06 1.076353e-06 2.316577e-07 9.478638e-08
#>               [75,80)      [80,85)     [85,Inf)
#> [0,5)    1.637249e-03 6.277160e-04 2.245740e-04
#> [5,10)   3.132972e-03 5.740460e-04 7.542728e-05
#> [10,15)  4.572554e-03 1.032251e-03 5.586263e-05
#> [15,20)  2.352051e-03 9.414950e-04 7.201032e-05
#> [20,25)  6.409747e-04 2.979315e-04 3.909510e-05
#> [25,30)  2.856903e-04 8.093756e-05 1.224067e-05
#> [30,35)  5.651474e-04 1.027495e-04 1.065650e-05
#> [35,40)  2.021710e-03 5.043518e-04 4.909649e-05
#> [40,45)  3.461974e-03 1.801228e-03 3.190727e-04
#> [45,50)  1.983281e-03 1.886933e-03 6.811101e-04
#> [50,55)  8.322200e-04 7.626230e-04 3.672824e-04
#> [55,60)  6.024879e-04 3.199016e-04 9.558610e-05
#> [60,65)  4.653549e-04 1.952078e-04 3.920004e-05
#> [65,70)  4.461819e-04 1.412956e-04 3.169324e-05
#> [70,75)  2.896974e-03 2.121656e-04 3.225385e-05
#> [75,80)  2.080308e-02 1.693306e-03 3.348699e-05
#> [80,85)  1.150224e-03 4.016454e-03 7.174651e-05
#> [85,Inf) 4.368232e-07 1.563535e-05 3.875418e-05
#> 
#> $other
#>               [0,5)     [5,10)    [10,15)    [15,20)    [20,25)    [25,30)
#> [0,5)    0.54403137 0.24316103 0.09348851 0.12561128 0.25695263 0.44205429
#> [5,10)   0.32291203 1.13831226 0.41781833 0.17166409 0.18493424 0.29615303
#> [10,15)  0.07422867 0.38979219 1.86033721 0.86439583 0.28995332 0.22231923
#> [15,20)  0.05680629 0.08453514 0.39185369 2.83355375 1.43906800 0.45206662
#> [20,25)  0.08722447 0.08087804 0.12815529 0.68280014 2.70069753 1.27501456
#> [25,30)  0.11458558 0.11018614 0.12303320 0.25847156 0.81292020 1.71447530
#> [30,35)  0.12179883 0.13359908 0.14578449 0.24467091 0.46188639 0.82590852
#> [35,40)  0.11061585 0.14742968 0.16791595 0.25212732 0.40959642 0.62503440
#> [40,45)  0.07912148 0.12066086 0.17356519 0.27123435 0.36511746 0.46131238
#> [45,50)  0.05974748 0.07824959 0.13491087 0.28098360 0.41131557 0.41770685
#> [50,55)  0.05834822 0.05927578 0.08851476 0.22714852 0.46456449 0.56001346
#> [55,60)  0.05744841 0.06254759 0.07243353 0.15539689 0.36613038 0.60779782
#> [60,65)  0.04602407 0.06710877 0.08038250 0.13148754 0.24235888 0.41359701
#> [65,70)  0.03737796 0.05818253 0.08572359 0.14669978 0.21093030 0.27401242
#> [70,75)  0.04559014 0.05111458 0.06966329 0.14113482 0.22571120 0.26610560
#> [75,80)  0.06189781 0.05358440 0.04748767 0.08363439 0.15763765 0.22200716
#> [80,85)  0.05084362 0.05091792 0.03381264 0.03597608 0.05605195 0.08980676
#> [85,Inf) 0.01505556 0.02584677 0.02390047 0.02052284 0.01847426 0.02123165
#>             [30,35)    [35,40)    [40,45)    [45,50)    [50,55)    [55,60)
#> [0,5)    0.51716626 0.40417461 0.27390466 0.21388711 0.20151981 0.20597855
#> [5,10)   0.45550002 0.48132480 0.34192266 0.21161275 0.14892935 0.13416035
#> [10,15)  0.27181521 0.35674841 0.34613489 0.23596584 0.13486875 0.08831114
#> [15,20)  0.28894477 0.28198958 0.31067204 0.27950009 0.18245853 0.10035537
#> [20,25)  0.52241755 0.34718182 0.31296028 0.30566405 0.25020052 0.15980770
#> [25,30)  0.93834720 0.49620523 0.35305723 0.31567729 0.29275914 0.23848326
#> [30,35)  1.04673660 0.68292642 0.41826840 0.31617021 0.28802170 0.28266483
#> [35,40)  0.81322159 0.78627716 0.54523947 0.35020657 0.25886768 0.24648566
#> [40,45)  0.60031560 0.70730646 0.65778955 0.45777125 0.27946364 0.19618818
#> [45,50)  0.41703360 0.48559406 0.57815607 0.57204855 0.39773162 0.23498697
#> [50,55)  0.47136349 0.40145303 0.43081512 0.52038901 0.52605450 0.39381453
#> [55,60)  0.63772901 0.50335393 0.41696387 0.44912624 0.53070642 0.52993434
#> [60,65)  0.55707275 0.54351327 0.44180902 0.40043256 0.45140815 0.53518784
#> [65,70)  0.35196807 0.40285417 0.38316585 0.33888916 0.33634807 0.40486037
#> [70,75)  0.28571998 0.31172724 0.33230517 0.32082561 0.29166015 0.29865399
#> [75,80)  0.24289456 0.24583258 0.26515759 0.29356233 0.28963023 0.26110070
#> [80,85)  0.11645484 0.12261173 0.12757544 0.15128803 0.18290122 0.19066178
#> [85,Inf) 0.02747873 0.03060271 0.02960122 0.03120086 0.03988155 0.05337275
#>             [60,65)    [65,70)    [70,75)    [75,80)    [80,85)    [85,Inf)
#> [0,5)    0.18575037 0.13929039 0.08562942 0.04036902 0.01616665 0.008156915
#> [5,10)   0.12896983 0.11222517 0.07771916 0.03985482 0.01617919 0.007294794
#> [10,15)  0.07535028 0.07327361 0.06230548 0.03937546 0.01857664 0.007299187
#> [15,20)  0.06023491 0.04848428 0.04462853 0.03624894 0.02306277 0.010799795
#> [20,25)  0.08446076 0.04786488 0.03570835 0.02930010 0.02219845 0.013283076
#> [25,30)  0.14641769 0.07221060 0.03856200 0.02598778 0.01992045 0.013984125
#> [30,35)  0.22962564 0.13462835 0.06473369 0.03213479 0.02091991 0.016316009
#> [35,40)  0.24829425 0.20094018 0.11744716 0.05333331 0.02682873 0.019592744
#> [40,45)  0.17417690 0.17167049 0.14377669 0.08221528 0.03782401 0.021602035
#> [45,50)  0.14504059 0.11537932 0.11124630 0.08777199 0.04972475 0.024921661
#> [50,55)  0.22500561 0.12639869 0.09294261 0.07735239 0.05596746 0.032460512
#> [55,60)  0.39643432 0.22217772 0.12260660 0.07886070 0.05695204 0.039326378
#> [60,65)  0.50530560 0.35694137 0.19763612 0.10101429 0.05931262 0.041175387
#> [65,70)  0.48478987 0.47713924 0.30263715 0.14399626 0.06952051 0.042304398
#> [70,75)  0.35261580 0.44536682 0.45716872 0.23150204 0.09548488 0.049017934
#> [75,80)  0.24221046 0.26796857 0.34274768 0.35465835 0.15283918 0.061335791
#> [80,85)  0.16175914 0.13606807 0.13719212 0.17081158 0.18514308 0.076762138
#> [85,Inf) 0.05824588 0.05080324 0.04141282 0.03896659 0.04927438 0.062365393
#> 
#> $all
#>              [0,5)     [5,10)    [10,15)   [15,20)   [20,25)   [25,30)
#> [0,5)    3.6895935  1.3132231  0.3697318 0.3487452 0.6041405 1.0509609
#> [5,10)   1.1927592 16.3817869  2.9371652 0.4133637 0.3780128 0.6246057
#> [10,15)  0.2238016  2.1624510 28.0602447 2.4807192 0.5043675 0.4067916
#> [15,20)  0.1839699  0.2746643  1.5836553 8.0810116 2.2865637 0.7664181
#> [20,25)  0.3290588  0.3329930  0.4341717 1.4045122 4.5206859 2.3472896
#> [25,30)  0.5330927  0.5639382  0.5680312 0.6680091 1.8267583 3.5995841
#> [30,35)  0.6494598  0.7849030  0.7673174 0.6746491 1.1339844 2.0295971
#> [35,40)  0.5470051  0.9933268  1.0042901 0.7786231 1.0802607 1.5881612
#> [40,45)  0.3935491  0.9339111  1.2532687 1.0170568 1.1236687 1.3931547
#> [45,50)  0.3521003  0.8582679  1.2552804 1.1159494 1.2861841 1.3223339
#> [50,55)  0.3885779  0.8654831  1.1114814 0.8743223 1.2848628 1.4587598
#> [55,60)  0.3633756  0.7384556  0.7598393 0.5350152 0.9090725 1.3349176
#> [60,65)  0.2244557  0.4261983  0.4217016 0.3400013 0.5270780 0.8208666
#> [65,70)  0.1362098  0.2219917  0.2680058 0.2974749 0.3761659 0.4754469
#> [70,75)  0.1240947  0.1544485  0.1949049 0.2812831 0.3690823 0.4117669
#> [75,80)  0.1582487  0.1509751  0.1500663 0.2155127 0.3071017 0.3667688
#> [80,85)  0.1922582  0.1821202  0.1558363 0.1724409 0.2139199 0.2538331
#> [85,Inf) 0.1472576  0.1908878  0.2105501 0.2110619 0.2054485 0.2272264
#>            [30,35)   [35,40)   [40,45)   [45,50)   [50,55)   [55,60)   [60,65)
#> [0,5)    1.2932740 1.0326573 0.6849349 0.4858026 0.4188858 0.4049706 0.3427047
#> [5,10)   1.1253204 1.3959959 1.0856648 0.6892128 0.4475281 0.3237990 0.2826394
#> [10,15)  0.6429584 1.1209888 1.2908185 0.9186822 0.5274091 0.2874809 0.1900947
#> [15,20)  0.5619415 0.7347037 1.0431740 1.0794748 0.7215632 0.3490682 0.1672740
#> [20,25)  1.1156948 0.8121997 0.8281865 0.9421941 0.8680664 0.5234342 0.2379351
#> [25,30)  2.1759554 1.2434413 0.9441265 0.8953105 0.8857913 0.7277497 0.3997642
#> [30,35)  2.6892457 1.7537840 1.1114405 0.8867679 0.7877649 0.7264510 0.5545069
#> [35,40)  2.0671815 2.2102634 1.5074577 1.0104719 0.7509052 0.6189473 0.5483190
#> [40,45)  1.6461249 1.8906183 1.9364639 1.3502821 0.8391785 0.5515572 0.4074010
#> [45,50)  1.3022279 1.3691815 1.6043817 1.7258235 1.1211857 0.6079645 0.3404574
#> [50,55)  1.2650856 1.0926476 1.1317239 1.4056605 1.5167982 0.9157515 0.4346965
#> [55,60)  1.3373349 1.0713841 0.9130907 0.9888647 1.2264677 1.2992480 0.7331579
#> [60,65)  1.0581413 1.0079604 0.8024731 0.7180904 0.7972785 1.0042987 1.0522377
#> [65,70)  0.6325682 0.7730553 0.7238492 0.5886315 0.5376375 0.6199378 0.8055603
#> [70,75)  0.4547034 0.5609059 0.6585177 0.6063426 0.4839086 0.4392534 0.5057193
#> [75,80)  0.3816101 0.4102587 0.5099300 0.5949772 0.5297121 0.4058778 0.3441485
#> [80,85)  0.2676609 0.2666831 0.3073807 0.4161017 0.4879830 0.4183977 0.2927958
#> [85,Inf) 0.2610035 0.2615682 0.2499981 0.2955067 0.4206571 0.5211124 0.4356389
#>            [65,70)    [70,75)    [75,80)    [80,85)   [85,Inf)
#> [0,5)    0.2406675 0.14677984 0.07573211 0.03279610 0.01450096
#> [5,10)   0.2327125 0.15462257 0.08232941 0.03735281 0.01637475
#> [10,15)  0.1665602 0.13686557 0.08456836 0.04000831 0.01726828
#> [15,20)  0.1122875 0.10084732 0.08034392 0.04704745 0.02181302
#> [20,25)  0.1210713 0.08880385 0.07616515 0.05673360 0.03427445
#> [25,30)  0.1771201 0.09437361 0.06938270 0.05856269 0.04694634
#> [30,35)  0.2974082 0.13585781 0.07238769 0.05380179 0.05032291
#> [35,40)  0.4251325 0.23691087 0.10858031 0.06004678 0.05246734
#> [40,45)  0.3697025 0.30888627 0.17622761 0.08638930 0.06115267
#> [45,50)  0.2495500 0.24663558 0.20546589 0.12195588 0.08019042
#> [50,55)  0.2315658 0.17841485 0.16854334 0.13641386 0.09921076
#> [55,60)  0.3432577 0.18875048 0.13614073 0.11765481 0.10027302
#> [60,65)  0.5869893 0.28030810 0.14614825 0.09798837 0.08499276
#> [65,70)  0.8973964 0.49150038 0.21034466 0.10295759 0.07217748
#> [70,75)  0.7030022 0.81110826 0.38891971 0.14874104 0.07645608
#> [75,80)  0.3914966 0.56221059 0.64944307 0.27751813 0.10345950
#> [80,85)  0.2302802 0.25130136 0.35399561 0.40144302 0.17288831
#> [85,Inf) 0.2724736 0.17929013 0.16311458 0.19801633 0.22720231
```

``` r
# this code is erroring for the moment - something to do with rendering a large plot I think.
# plot_setting_matrices(
#   synthetic_settings_5y_sydney,
#   title = "Setting-specific synthetic contact matrices (Sydney 2020 projected)"
# )
```

``` r
set.seed(2021-09-24)
plot_matrix(synthetic_settings_5y_sydney$home)
```

<img src="man/figures/README-plot-matrix-differents-1.png" width="100%" />

``` r
plot_matrix(synthetic_settings_5y_sydney$work)
```

<img src="man/figures/README-plot-matrix-differents-2.png" width="100%" />

``` r
plot_matrix(synthetic_settings_5y_sydney$school)
```

<img src="man/figures/README-plot-matrix-differents-3.png" width="100%" />

``` r
plot_matrix(synthetic_settings_5y_sydney$other)
```

<img src="man/figures/README-plot-matrix-differents-4.png" width="100%" />

``` r
plot_matrix(synthetic_settings_5y_sydney$all)
```

<img src="man/figures/README-plot-matrix-differents-5.png" width="100%" />

``` r
# build synthetic age-structured contact matrices with GAMs
# analysis of polymod data

# set age breaks
age_breaks_5y <- c(seq(0, 75, by = 5), Inf)
age_breaks_1y <- c(seq(0, 100, by = 1), Inf)

# fit a single overall contact model to polymod
m_all <- fit_single_contact_model(
  contact_data = get_polymod_contact_data("all"),
  population = get_polymod_population()
)

m_all
#> 
#> Family: poisson 
#> Link function: log 
#> 
#> Formula:
#> contacts ~ stats::offset(log(pop_age_to)) + s(age_to) + s(age_from) + 
#>     s(abs(age_from - age_to)) + s(abs(age_from - age_to), age_from) + 
#>     school_probability + work_probability
#> 
#> Estimated degrees of freedom:
#>  8.55  8.99  8.71 26.91  total = 57.17 
#> 
#> fREML score: 21288.94
```

``` r
# predict contacts at 1y and 5y resolutions for inspection
synthetic_all_5y <- predict_contacts(
  model = m_all, 
  population = get_polymod_population(),
  age_breaks = age_breaks_5y
) %>%
  predictions_to_matrix()

synthetic_all_5y
#>              [0,5)    [5,10)   [10,15)   [15,20)   [20,25)   [25,30)   [30,35)
#> [0,5)    2.2963473 0.9954570 0.2690432 0.2401278 0.4176857 0.7776559 1.0661186
#> [5,10)   0.9262598 5.9251520 1.6419113 0.3292330 0.2996084 0.6023135 1.1434338
#> [10,15)  0.1565314 1.4494358 8.6923543 1.7898820 0.3212981 0.3477162 0.6606544
#> [15,20)  0.1500297 0.2490894 1.6238950 7.7951945 1.6832053 0.4939471 0.5221934
#> [20,25)  0.3074250 0.2996552 0.3745352 1.3676147 4.8941151 1.7436817 0.8260151
#> [25,30)  0.4355680 0.5088823 0.5183657 0.5876872 1.2379435 2.7859584 1.6734717
#> [30,35)  0.4746651 0.6186056 0.6779792 0.7233495 0.8835537 1.4193213 2.0342341
#> [35,40)  0.4685909 0.7236571 0.7896170 0.7708846 0.8850875 1.2914982 1.8537051
#> [40,45)  0.3565839 0.6697092 0.9058580 0.8723808 0.7941816 0.9720953 1.4938490
#> [45,50)  0.2665422 0.4591983 0.7781999 0.9969970 0.9500705 0.8634722 0.9684862
#> [50,55)  0.2657138 0.3339959 0.4940383 0.7937007 1.0838449 1.1639807 1.0422603
#> [55,60)  0.2778649 0.3441993 0.3603803 0.4624422 0.7291091 1.1166532 1.2899310
#> [60,65)  0.2036336 0.3559201 0.3694426 0.3363173 0.3898379 0.6026266 0.9177781
#> [65,70)  0.1187313 0.2518708 0.3455099 0.3378025 0.3170296 0.3676961 0.5072615
#> [70,75)  0.1102090 0.1651072 0.2201451 0.2683486 0.3052518 0.3510717 0.4200585
#> [75,Inf) 0.2500931 0.2796277 0.2106047 0.1897847 0.2075288 0.2262051 0.2726051
#>            [35,40)   [40,45)   [45,50)   [50,55)   [55,60)   [60,65)   [65,70)
#> [0,5)    0.9480140 0.6550043 0.4600338 0.3819001 0.3707677 0.3513947 0.2741184
#> [5,10)   1.3631002 1.0110383 0.6107574 0.3886353 0.2904820 0.2451264 0.2096873
#> [10,15)  1.0883204 1.1112313 0.7604136 0.4398817 0.2591235 0.1819468 0.1536536
#> [15,20)  0.7932449 1.0314373 0.9320557 0.6178287 0.3397465 0.1894407 0.1327236
#> [20,25)  0.8021329 0.9254588 0.9601410 0.7950004 0.5077393 0.2694222 0.1470313
#> [25,30)  1.1024617 0.9827594 0.9559278 0.8699027 0.6648038 0.4045170 0.2074307
#> [30,35)  1.6197590 1.1760356 0.9669560 0.8674737 0.7534110 0.5622507 0.3337259
#> [35,40)  1.9513208 1.5747012 1.0904068 0.7980547 0.6697996 0.5923738 0.4659582
#> [40,45)  2.0069325 1.9449726 1.4264983 0.8618389 0.5379299 0.4210292 0.3984519
#> [45,50)  1.3330599 1.7699660 1.7988224 1.2167854 0.6189072 0.3279551 0.2510159
#> [50,55)  0.9684055 1.1341312 1.4911223 1.5644866 1.0024125 0.4623127 0.2344875
#> [55,60)  1.1100196 0.9363295 1.0290286 1.3096393 1.2913752 0.7816627 0.3618516
#> [60,65)  1.0385299 0.9016265 0.7993713 0.8976429 1.0802494 1.0168764 0.5779586
#> [65,70)  0.6658490 0.7105327 0.6505417 0.6229405 0.6949076 0.8347835 0.8551180
#> [70,75)  0.5085394 0.5879550 0.5957980 0.5317349 0.4686782 0.4831669 0.6535308
#> [75,Inf) 0.3346789 0.3954108 0.4515898 0.4552492 0.3648541 0.2534761 0.2189633
#>            [70,75)  [75,Inf)
#> [0,5)    0.1660324 0.1232727
#> [5,10)   0.1533068 0.1295294
#> [10,15)  0.1313933 0.1439697
#> [15,20)  0.1142899 0.1780028
#> [20,25)  0.1016822 0.1807689
#> [25,30)  0.1087913 0.1641586
#> [30,35)  0.1652330 0.1819485
#> [35,40)  0.2809858 0.2702781
#> [40,45)  0.3441476 0.4198565
#> [45,50)  0.2553163 0.5076275
#> [50,55)  0.1790761 0.4668625
#> [55,60)  0.1900274 0.3857108
#> [60,65)  0.2682658 0.3404124
#> [65,70)  0.4345667 0.3685118
#> [70,75)  0.8493007 0.5957497
#> [75,Inf) 0.3384421 1.2093121
```

``` r
set.seed(2021-09-08)
# predict contacts at 1y and 5y resolutions for inspection
synthetic_all_5y <- predict_contacts(
  model = m_all, 
  population = get_polymod_population(),
  age_breaks = age_breaks_5y
) %>%
  predictions_to_matrix()

synthetic_all_5y
#>              [0,5)    [5,10)   [10,15)   [15,20)   [20,25)   [25,30)   [30,35)
#> [0,5)    2.2963473 0.9954570 0.2690432 0.2401278 0.4176857 0.7776559 1.0661186
#> [5,10)   0.9262598 5.9251520 1.6419113 0.3292330 0.2996084 0.6023135 1.1434338
#> [10,15)  0.1565314 1.4494358 8.6923543 1.7898820 0.3212981 0.3477162 0.6606544
#> [15,20)  0.1500297 0.2490894 1.6238950 7.7951945 1.6832053 0.4939471 0.5221934
#> [20,25)  0.3074250 0.2996552 0.3745352 1.3676147 4.8941151 1.7436817 0.8260151
#> [25,30)  0.4355680 0.5088823 0.5183657 0.5876872 1.2379435 2.7859584 1.6734717
#> [30,35)  0.4746651 0.6186056 0.6779792 0.7233495 0.8835537 1.4193213 2.0342341
#> [35,40)  0.4685909 0.7236571 0.7896170 0.7708846 0.8850875 1.2914982 1.8537051
#> [40,45)  0.3565839 0.6697092 0.9058580 0.8723808 0.7941816 0.9720953 1.4938490
#> [45,50)  0.2665422 0.4591983 0.7781999 0.9969970 0.9500705 0.8634722 0.9684862
#> [50,55)  0.2657138 0.3339959 0.4940383 0.7937007 1.0838449 1.1639807 1.0422603
#> [55,60)  0.2778649 0.3441993 0.3603803 0.4624422 0.7291091 1.1166532 1.2899310
#> [60,65)  0.2036336 0.3559201 0.3694426 0.3363173 0.3898379 0.6026266 0.9177781
#> [65,70)  0.1187313 0.2518708 0.3455099 0.3378025 0.3170296 0.3676961 0.5072615
#> [70,75)  0.1102090 0.1651072 0.2201451 0.2683486 0.3052518 0.3510717 0.4200585
#> [75,Inf) 0.2500931 0.2796277 0.2106047 0.1897847 0.2075288 0.2262051 0.2726051
#>            [35,40)   [40,45)   [45,50)   [50,55)   [55,60)   [60,65)   [65,70)
#> [0,5)    0.9480140 0.6550043 0.4600338 0.3819001 0.3707677 0.3513947 0.2741184
#> [5,10)   1.3631002 1.0110383 0.6107574 0.3886353 0.2904820 0.2451264 0.2096873
#> [10,15)  1.0883204 1.1112313 0.7604136 0.4398817 0.2591235 0.1819468 0.1536536
#> [15,20)  0.7932449 1.0314373 0.9320557 0.6178287 0.3397465 0.1894407 0.1327236
#> [20,25)  0.8021329 0.9254588 0.9601410 0.7950004 0.5077393 0.2694222 0.1470313
#> [25,30)  1.1024617 0.9827594 0.9559278 0.8699027 0.6648038 0.4045170 0.2074307
#> [30,35)  1.6197590 1.1760356 0.9669560 0.8674737 0.7534110 0.5622507 0.3337259
#> [35,40)  1.9513208 1.5747012 1.0904068 0.7980547 0.6697996 0.5923738 0.4659582
#> [40,45)  2.0069325 1.9449726 1.4264983 0.8618389 0.5379299 0.4210292 0.3984519
#> [45,50)  1.3330599 1.7699660 1.7988224 1.2167854 0.6189072 0.3279551 0.2510159
#> [50,55)  0.9684055 1.1341312 1.4911223 1.5644866 1.0024125 0.4623127 0.2344875
#> [55,60)  1.1100196 0.9363295 1.0290286 1.3096393 1.2913752 0.7816627 0.3618516
#> [60,65)  1.0385299 0.9016265 0.7993713 0.8976429 1.0802494 1.0168764 0.5779586
#> [65,70)  0.6658490 0.7105327 0.6505417 0.6229405 0.6949076 0.8347835 0.8551180
#> [70,75)  0.5085394 0.5879550 0.5957980 0.5317349 0.4686782 0.4831669 0.6535308
#> [75,Inf) 0.3346789 0.3954108 0.4515898 0.4552492 0.3648541 0.2534761 0.2189633
#>            [70,75)  [75,Inf)
#> [0,5)    0.1660324 0.1232727
#> [5,10)   0.1533068 0.1295294
#> [10,15)  0.1313933 0.1439697
#> [15,20)  0.1142899 0.1780028
#> [20,25)  0.1016822 0.1807689
#> [25,30)  0.1087913 0.1641586
#> [30,35)  0.1652330 0.1819485
#> [35,40)  0.2809858 0.2702781
#> [40,45)  0.3441476 0.4198565
#> [45,50)  0.2553163 0.5076275
#> [50,55)  0.1790761 0.4668625
#> [55,60)  0.1900274 0.3857108
#> [60,65)  0.2682658 0.3404124
#> [65,70)  0.4345667 0.3685118
#> [70,75)  0.8493007 0.5957497
#> [75,Inf) 0.3384421 1.2093121

library(ggplot2)
plot_matrix(synthetic_all_5y) +
  ggtitle("synthetic all at once")
```

<img src="man/figures/README-matrix-plot-1.png" width="100%" />

## Speeding up computation with `future`

`conmat` now supports parallelisation, which is useful in a couple of
contexts with the model fitting, here is an example:

``` r
library(future)
plan(multisession, workers = 4)
```

We set the future plan, saying multisession, with 4 workers.

Then we run the code as normal:

``` r
polymod_setting_data <- get_polymod_setting_data()
polymod_population <- get_polymod_population()

contact_model <- fit_setting_contacts(
  contact_data_list = polymod_setting_data,
  population = polymod_population
)

contact_model_pred <- predict_setting_contacts(
  population = polymod_population,
  contact_model = contact_model,
  age_breaks = c(seq(0, 75, by = 5), Inf)
)
```

Notably this is about 3 times faster than without using that plan.

## Data sources

This package provides data for use in calculating contact matrices.

These data are still being cleaned and processed, but their current
forms are shown below:

### abs_education_state

``` r
abs_education_state
#> # A tibble: 4,194 × 5
#>     year state aboriginal_and_torres_strait_islander_status   age n_full_and_part…
#>    <dbl> <chr> <chr>                                        <dbl>            <dbl>
#>  1  2006 ACT   Aboriginal and Torres Strait Islander            4                5
#>  2  2006 ACT   Non-Indigenous                                   4              109
#>  3  2006 NSW   Aboriginal and Torres Strait Islander            4              104
#>  4  2006 NSW   Non-Indigenous                                   4             1870
#>  5  2006 NT    Aboriginal and Torres Strait Islander            4              102
#>  6  2006 NT    Non-Indigenous                                   4               63
#>  7  2006 QLD   Aboriginal and Torres Strait Islander            4               37
#>  8  2006 QLD   Non-Indigenous                                   4              740
#>  9  2006 SA    Aboriginal and Torres Strait Islander            4               42
#> 10  2006 SA    Non-Indigenous                                   4             1023
#> # … with 4,184 more rows
```

### abs_education_state_2020

``` r
abs_education_state_2020
#> # A tibble: 808 × 6
#>     year state   age population population_interpolated  prop
#>    <dbl> <chr> <dbl>      <dbl>                   <dbl> <dbl>
#>  1  2020 ACT       0          0                   5569. 0    
#>  2  2020 ACT       1          0                   5702. 0    
#>  3  2020 ACT       2          0                   5781. 0    
#>  4  2020 ACT       3          0                   5814. 0    
#>  5  2020 ACT       4          0                   5809. 0    
#>  6  2020 ACT       5       4558                   5772. 0.790
#>  7  2020 ACT       6       6161                   5710. 1.08 
#>  8  2020 ACT       7       6163                   5623. 1.10 
#>  9  2020 ACT       8       5881                   5510. 1.07 
#> 10  2020 ACT       9       5921                   5370. 1.10 
#> # … with 798 more rows
```

### abs_employ_age_lga

``` r
abs_employ_age_lga
#> # A tibble: 5,600 × 8
#>     year state lga    age_group total_employed total_unemployed total_labour_fo…
#>    <dbl> <chr> <chr>  <fct>              <dbl>            <dbl>            <dbl>
#>  1  2016 NSW   Albur… 15-19               1527              300             1830
#>  2  2016 NSW   Armid… 15-19                838              217             1055
#>  3  2016 NSW   Balli… 15-19               1064              185             1255
#>  4  2016 NSW   Balra… 15-19                 41                9               46
#>  5  2016 NSW   Bathu… 15-19               1103              241             1341
#>  6  2016 NSW   Bega … 15-19                801               97              897
#>  7  2016 NSW   Belli… 15-19                241               42              281
#>  8  2016 NSW   Berri… 15-19                168               16              181
#>  9  2016 NSW   Black… 15-19               7534             2136             9670
#> 10  2016 NSW   Bland… 15-19                124               14              140
#> # … with 5,590 more rows, and 1 more variable: total <dbl>
```

### abs_household_lga

``` r
abs_household_lga
#> # A tibble: 4,968 × 5
#>     year state lga                   n_persons_usually_resident n_households
#>    <dbl> <chr> <chr>                 <chr>                             <dbl>
#>  1  2016 NSW   Albury (C)            total                             19495
#>  2  2016 NSW   Albury (C)            1                                  6020
#>  3  2016 NSW   Albury (C)            2                                  6738
#>  4  2016 NSW   Albury (C)            3                                  2740
#>  5  2016 NSW   Albury (C)            4                                  2541
#>  6  2016 NSW   Albury (C)            5                                  1041
#>  7  2016 NSW   Albury (C)            6                                   311
#>  8  2016 NSW   Albury (C)            7                                    56
#>  9  2016 NSW   Albury (C)            8+                                   42
#> 10  2016 NSW   Armidale Regional (A) total                             10276
#> # … with 4,958 more rows
```

### abs_pop_age_lga_2016

``` r
abs_pop_age_lga_2016
#> # A tibble: 9,792 × 5
#>     year state lga                age_group population
#>    <dbl> <chr> <chr>              <fct>          <dbl>
#>  1  2016 ACT   Unincorporated ACT 0-4            28054
#>  2  2016 ACT   Unincorporated ACT 5-9            25767
#>  3  2016 ACT   Unincorporated ACT 10-14          22170
#>  4  2016 ACT   Unincorporated ACT 15-19          24906
#>  5  2016 ACT   Unincorporated ACT 20-24          32615
#>  6  2016 ACT   Unincorporated ACT 25-29          34243
#>  7  2016 ACT   Unincorporated ACT 30-34          34574
#>  8  2016 ACT   Unincorporated ACT 35-39          30340
#>  9  2016 ACT   Unincorporated ACT 40-44          28387
#> 10  2016 ACT   Unincorporated ACT 45-49          26431
#> # … with 9,782 more rows
```

### abs_pop_age_lga_2020

``` r
abs_pop_age_lga_2020
#> # A tibble: 9,774 × 5
#>     year state lga                age_group population
#>    <dbl> <chr> <chr>              <fct>          <dbl>
#>  1  2020 ACT   Unincorporated ACT 0-4            27861
#>  2  2020 ACT   Unincorporated ACT 5-9            28871
#>  3  2020 ACT   Unincorporated ACT 10-14          26015
#>  4  2020 ACT   Unincorporated ACT 15-19          23867
#>  5  2020 ACT   Unincorporated ACT 20-24          32626
#>  6  2020 ACT   Unincorporated ACT 25-29          33992
#>  7  2020 ACT   Unincorporated ACT 30-34          35734
#>  8  2020 ACT   Unincorporated ACT 35-39          35354
#>  9  2020 ACT   Unincorporated ACT 40-44          30155
#> 10  2020 ACT   Unincorporated ACT 45-49          29103
#> # … with 9,764 more rows
```

### abs_state_age

``` r
abs_state_age
#> # A tibble: 168 × 3
#>    state age_group population
#>    <chr> <fct>          <dbl>
#>  1 NSW   0-4           495060
#>  2 VIC   0-4           401992
#>  3 QLD   0-4           314592
#>  4 SA    0-4            98400
#>  5 WA    0-4           171531
#>  6 TAS   0-4            29258
#>  7 NT    0-4            17766
#>  8 ACT   0-4            27846
#>  9 NSW   5-9           512687
#> 10 VIC   5-9           416633
#> # … with 158 more rows
```

## Code of Conduct

Please note that the conmat project is released with a [Contributor Code
of
Conduct](https://contributor-covenant.org/version/2/0/CODE_OF_CONDUCT.html).
By contributing to this project, you agree to abide by its terms.
