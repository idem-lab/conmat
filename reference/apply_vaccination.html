<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Apply vaccination effects to next generation contact matrices — apply_vaccination • conmat</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Apply vaccination effects to next generation contact matrices — apply_vaccination"><meta name="description" content="Applies the effect of vaccination on the next generation of
infections, to understand and describe the reduction of acquisition and
transmission in each age group."><meta property="og:description" content="Applies the effect of vaccination on the next generation of
infections, to understand and describe the reduction of acquisition and
transmission in each age group."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">conmat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/conmat-population.html">Conmat Population Data</a></li>
    <li><a class="dropdown-item" href="../articles/data-sources.html">Data Sources</a></li>
    <li><a class="dropdown-item" href="../articles/example-pipeline.html">Example Pipeline</a></li>
    <li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="../articles/other-data-sources.html">Using other data sources</a></li>
    <li><a class="dropdown-item" href="../articles/parallel-computing.html">Parallel Computing</a></li>
    <li><a class="dropdown-item" href="../articles/sir-model.html">SIR modelling with conmat</a></li>
    <li><a class="dropdown-item" href="../articles/visualising-conmat.html">Visualisation gallery</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/idem-lab/conmat/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Apply vaccination effects to next generation contact matrices</h1>
      <small class="dont-index">Source: <a href="https://github.com/idem-lab/conmat/blob/master/R/apply_vaccination.R" class="external-link"><code>R/apply_vaccination.R</code></a></small>
      <div class="d-none name"><code>apply_vaccination.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Applies the effect of vaccination on the next generation of
infections, to understand and describe the reduction of acquisition and
transmission in each age group.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">apply_vaccination</span><span class="op">(</span><span class="va">ngm</span>, <span class="va">data</span>, <span class="va">coverage_col</span>, <span class="va">acquisition_col</span>, <span class="va">transmission_col</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-ngm">ngm<a class="anchor" aria-label="anchor" href="#arg-ngm"></a></dt>
<dd><p>next generation matrices. See <code><a href="generate_ngm.html">generate_ngm()</a></code> for creating next
generation matrices of a state or a local government area for specific age
groups</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>data frame with location specific information on vaccine
coverage, efficacy of acquisition/susceptibility and efficacy of
transmission/infectiousness for the ordered age groups from lowest to
highest of the next generation matrix</p></dd>


<dt id="arg-coverage-col">coverage_col<a class="anchor" aria-label="anchor" href="#arg-coverage-col"></a></dt>
<dd><p>bare variable name for the column with information on
vaccine coverage by age groups</p></dd>


<dt id="arg-acquisition-col">acquisition_col<a class="anchor" aria-label="anchor" href="#arg-acquisition-col"></a></dt>
<dd><p>bare variable name for the column with information
on efficacy of acquisition</p></dd>


<dt id="arg-transmission-col">transmission_col<a class="anchor" aria-label="anchor" href="#arg-transmission-col"></a></dt>
<dd><p>bare variable name for the column with information
on efficacy of transmission</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>list of contact matrices, one for each setting with reduction in
transmission matching the next generation matrices</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Vaccination improves a person's immunity from a disease. When a
sizeable section of the population receives vaccinations or when vaccine
coverage is sufficient enough, the likelihood that the unvaccinated
population will contract the disease is decreased. This helps to slow
infectious disease spread as well as lessen its severity. For this reason,
it is important to understand how much of a reduction in probability of
acquisition (the likelihood that an individual will contract the disease),
and probability of transmission (the likelihood that an individual will
spread the disease after contracting it), has occurred as an the effect of
vaccination, in other words the effect of vaccination on the next
generation of infections.</p>
<p><code>apply_vaccination</code> returns the percentage reduction in acquisition and
transmission in each age group. It does this by taking the outer product
of these reductions in acquisition and transmission by age group, creating
a transmission reduction matrix. The next generation matrices with the
vaccination effects applied are then produced using the obtained
transmission reduction matrix and the next generation matrices passed to
the function as an argument.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># examples take 20 second to run so skipping</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># example data frame with vaccine coverage, acquisition and transmission</span></span></span>
<span class="r-in"><span><span class="co"># efficacy of different age groups</span></span></span>
<span class="r-in"><span><span class="va">vaccination_effect_example_data</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 17 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    age_band coverage acquisition transmission</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> 0-4         0           0            0    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> 5-11        0.782       0.583        0.254</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> 12-15       0.997       0.631        0.295</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> 16-19       0.965       0.786        0.469</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> 20-24       0.861       0.774        0.453</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> 25-29       0.997       0.778        0.458</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> 30-34       0.998       0.803        0.493</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> 35-39       0.998       0.829        0.533</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> 40-44       0.999       0.841        0.551</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> 45-49       0.993       0.847        0.562</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> 50-54       0.999       0.857        0.579</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span> 55-59       0.996       0.864        0.591</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">13</span> 60-64       0.998       0.858        0.581</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">14</span> 65-69       0.999       0.864        0.591</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">15</span> 70-74       0.999       0.867        0.597</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">16</span> 75-79       0.999       0.866        0.595</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">17</span> 80+         0.999       0.844        0.556</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate next generation matrices</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">perth</span> <span class="op">&lt;-</span> <span class="fu"><a href="abs_age_data.html">abs_age_lga</a></span><span class="op">(</span><span class="st">"Perth (C)"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">perth_hh</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_abs_per_capita_household_size.html">get_abs_per_capita_household_size</a></span><span class="op">(</span>lga <span class="op">=</span> <span class="st">"Perth (C)"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">age_breaks_0_80</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">80</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, <span class="cn">Inf</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># refit the model - note that the default if age_breaks isn't specified is</span></span></span>
<span class="r-in"><span><span class="co"># 0 to 75</span></span></span>
<span class="r-in"><span><span class="va">perth_contact_0_80</span> <span class="op">&lt;-</span> <span class="fu"><a href="extrapolate_polymod.html">extrapolate_polymod</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">perth</span>,</span></span>
<span class="r-in"><span>  per_capita_household_size <span class="op">=</span> <span class="va">perth_hh</span>,</span></span>
<span class="r-in"><span>  age_breaks <span class="op">=</span> <span class="va">age_breaks_0_80</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">perth_ngm_0_80</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate_ngm.html">generate_ngm</a></span><span class="op">(</span><span class="va">perth_contact_0_80</span>,</span></span>
<span class="r-in"><span>  age_breaks <span class="op">=</span> <span class="va">age_breaks_0_80</span>,</span></span>
<span class="r-in"><span>  per_capita_household_size <span class="op">=</span> <span class="va">perth_hh</span>,</span></span>
<span class="r-in"><span>  R_target <span class="op">=</span> <span class="fl">1.5</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># In the old way we used to be able to pass age_breaks_0_80 along</span></span></span>
<span class="r-in"><span><span class="fu"><a href="generate_ngm_oz.html">generate_ngm_oz</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  lga_name <span class="op">=</span> <span class="st">"Perth (C)"</span>,</span></span>
<span class="r-in"><span>  age_breaks <span class="op">=</span> <span class="va">age_breaks_0_80</span>,</span></span>
<span class="r-in"><span>  R_target <span class="op">=</span> <span class="fl">1.5</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">NGM Setting Matrices</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="font-style: italic;">A list of matrices, each </span><span style="color: #0000BB; font-style: italic;">&lt;matrix&gt;</span><span style="font-style: italic;"> containing the number of newly infected</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="font-style: italic;">individuals for a specified age group.</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="font-style: italic;">There are 17 age breaks, ranging 0-80+ years, with a regular 5 year interval</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> • <span style="font-weight: bold;">home</span>: a 17x17 <span style="color: #0000BB;">&lt;matrix&gt;</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> • <span style="font-weight: bold;">school</span>: a 17x17 <span style="color: #0000BB;">&lt;matrix&gt;</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> • <span style="font-weight: bold;">work</span>: a 17x17 <span style="color: #0000BB;">&lt;matrix&gt;</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> • <span style="font-weight: bold;">other</span>: a 17x17 <span style="color: #0000BB;">&lt;matrix&gt;</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> • <span style="font-weight: bold;">all</span>: a 17x17 <span style="color: #0000BB;">&lt;matrix&gt;</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Access each <span style="color: #0000BB;">&lt;matrix&gt;</span> with `x$name`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> e.g., `x$home`</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># another way to do this using the previous method for generating NGMs</span></span></span>
<span class="r-in"><span><span class="co"># The number of age breaks must match the vaccination effect data</span></span></span>
<span class="r-in"><span><span class="va">ngm_nsw</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate_ngm_oz.html">generate_ngm_oz</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  state_name <span class="op">=</span> <span class="st">"NSW"</span>,</span></span>
<span class="r-in"><span>  age_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">80</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, <span class="cn">Inf</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  R_target <span class="op">=</span> <span class="fl">1.5</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Apply vaccination effect to next generation matrices</span></span></span>
<span class="r-in"><span><span class="va">ngm_nsw_vacc</span> <span class="op">&lt;-</span> <span class="fu">apply_vaccination</span><span class="op">(</span></span></span>
<span class="r-in"><span>  ngm <span class="op">=</span> <span class="va">ngm_nsw</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">vaccination_effect_example_data</span>,</span></span>
<span class="r-in"><span>  coverage_col <span class="op">=</span> <span class="va">coverage</span>,</span></span>
<span class="r-in"><span>  acquisition_col <span class="op">=</span> <span class="va">acquisition</span>,</span></span>
<span class="r-in"><span>  transmission_col <span class="op">=</span> <span class="va">transmission</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nicholas Tierney, <a href="https://www.telethonkids.org.au/contact-us/our-people/g/nick-golding/" class="external-link">Nick Golding</a>, <a href="https://aarathybabu.netlify.app/" class="external-link">Aarathy Babu</a>, Chitra Saraswati, Michael Lydeamore.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

